<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>幸運抽籤程式</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
        }
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0.7;
            animation: fall 3s linear forwards;
        }
        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 flex items-center justify-center min-h-screen p-4">
    <div class="w-full max-w-2xl bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 md:p-8">
        <div class="text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 dark:text-white">幸運抽籤程式</h1>
            <p class="mt-2 text-gray-600 dark:text-gray-400">在下方輸入所有選項（一行一個），然後點擊按鈕抽出幸運兒！</p>
        </div>

        <div class="mt-8">
            <label for="items" class="block text-sm font-medium text-gray-700 dark:text-gray-300">抽籤選項</label>
            <textarea id="items" rows="8" class="mt-1 block w-full rounded-lg border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 bg-gray-50 dark:bg-gray-700 dark:text-white p-4" placeholder="例如：&#10;張三&#10;李四&#10;王五&#10;..."></textarea>
        </div>

        <div class="mt-6 flex flex-col items-center">
            <button id="drawButton" class="w-full md:w-auto px-8 py-3 text-lg font-semibold text-white bg-indigo-600 rounded-lg shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition-transform transform hover:scale-105 disabled:bg-indigo-400 disabled:cursor-not-allowed">
                開始抽籤！
            </button>
        </div>

        <div id="result-container" class="mt-8 text-center min-h-[100px] flex items-center justify-center">
             <p id="result" class="text-2xl md:text-3xl font-bold text-gray-800 dark:text-white transition-opacity duration-500 opacity-0"></p>
        </div>
    </div>

    <script>
        const drawButton = document.getElementById('drawButton');
        const itemsTextarea = document.getElementById('items');
        const resultParagraph = document.getElementById('result');
        const resultContainer = document.getElementById('result-container');

        let intervalId = null;

        drawButton.addEventListener('click', () => {
            const items = itemsTextarea.value.split('\n').map(item => item.trim()).filter(item => item !== '');

            if (items.length < 2) {
                resultParagraph.textContent = '請至少輸入兩個有效選項！';
                resultParagraph.classList.remove('text-indigo-500', 'dark:text-indigo-400');
                resultParagraph.classList.add('text-red-500', 'dark:text-red-400');
                resultParagraph.style.opacity = '1';
                return;
            }

            // 清除之前的結果和樣式
            resultParagraph.textContent = '';
            resultParagraph.classList.remove('text-red-500', 'dark:text-red-400');
            resultParagraph.classList.add('text-indigo-500', 'dark:text-indigo-400');
            resultParagraph.style.opacity = '1';
            drawButton.disabled = true;
            
            let shuffleCount = 0;
            intervalId = setInterval(() => {
                shuffleCount++;
                const randomIndex = Math.floor(Math.random() * items.length);
                resultParagraph.textContent = items[randomIndex];
                
                // 動畫效果結束
                if (shuffleCount > 20) { // 快速閃爍約 2 秒
                    clearInterval(intervalId);
                    finalizeWinner(items);
                }
            }, 100);
        });

        function finalizeWinner(items) {
            const winnerIndex = Math.floor(Math.random() * items.length);
            const winner = items[winnerIndex];
            
            resultParagraph.textContent = `🎉 中獎的是： ${winner} 🎉`;
            drawButton.disabled = false;
            createConfetti();
        }

        function createConfetti() {
            const confettiContainer = document.body;
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
                confettiContainer.appendChild(confetti);

                setTimeout(() => {
                    confetti.remove();
                }, 3000);
            }
        }
    </script>
</body>
</html>
